<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>decompiler: StackSolver Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">decompiler
   &#160;<span id="projectnumber">1.0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classStackSolver-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">StackSolver Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>A class that solves for stack-pointer changes across unknown sub-functions.  
 <a href="classStackSolver.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a441d8ed5d337ba9087093745d7e889c9"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a441d8ed5d337ba9087093745d7e889c9"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStackSolver.html#a441d8ed5d337ba9087093745d7e889c9">solve</a> (void)</td></tr>
<tr class="memdesc:a441d8ed5d337ba9087093745d7e889c9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solve the system of equations. <br /></td></tr>
<tr class="separator:a441d8ed5d337ba9087093745d7e889c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a136feaaa59c88d2a2b003621a78b0511"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStackSolver.html#a136feaaa59c88d2a2b003621a78b0511">build</a> (const <a class="el" href="classFuncdata.html">Funcdata</a> &amp;data, <a class="el" href="classAddrSpace.html">AddrSpace</a> *id, int4 spcbase)</td></tr>
<tr class="memdesc:a136feaaa59c88d2a2b003621a78b0511"><td class="mdescLeft">&#160;</td><td class="mdescRight">Build the system of equations.  <a href="#a136feaaa59c88d2a2b003621a78b0511">More...</a><br /></td></tr>
<tr class="separator:a136feaaa59c88d2a2b003621a78b0511"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a252605639003f1f4a19e763dd8725258"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a252605639003f1f4a19e763dd8725258"></a>
int4&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStackSolver.html#a252605639003f1f4a19e763dd8725258">getNumVariables</a> (void) const </td></tr>
<tr class="memdesc:a252605639003f1f4a19e763dd8725258"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the number of variables in the system. <br /></td></tr>
<tr class="separator:a252605639003f1f4a19e763dd8725258"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5950d1dfc8be3b6d07ad244830c39dd"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa5950d1dfc8be3b6d07ad244830c39dd"></a>
<a class="el" href="classVarnode.html">Varnode</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStackSolver.html#aa5950d1dfc8be3b6d07ad244830c39dd">getVariable</a> (int4 i) const </td></tr>
<tr class="memdesc:aa5950d1dfc8be3b6d07ad244830c39dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the i-th <a class="el" href="classVarnode.html" title="A low-level variable or contiguous set of bytes described by an Address and a size. ">Varnode</a> variable. <br /></td></tr>
<tr class="separator:aa5950d1dfc8be3b6d07ad244830c39dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6f806079752c06000281e8256af6c32"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af6f806079752c06000281e8256af6c32"></a>
int4&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStackSolver.html#af6f806079752c06000281e8256af6c32">getCompanion</a> (int4 i) const </td></tr>
<tr class="memdesc:af6f806079752c06000281e8256af6c32"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the i-th variable's companion index. <br /></td></tr>
<tr class="separator:af6f806079752c06000281e8256af6c32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b289a2bab4a8534b9ab14ceea55b380"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5b289a2bab4a8534b9ab14ceea55b380"></a>
int4&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStackSolver.html#a5b289a2bab4a8534b9ab14ceea55b380">getSolution</a> (int4 i) const </td></tr>
<tr class="memdesc:a5b289a2bab4a8534b9ab14ceea55b380"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the i-th variable's solution. <br /></td></tr>
<tr class="separator:a5b289a2bab4a8534b9ab14ceea55b380"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a63d15f6d3662262cab274d1035f472ba"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a63d15f6d3662262cab274d1035f472ba"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStackSolver.html#a63d15f6d3662262cab274d1035f472ba">duplicate</a> (void)</td></tr>
<tr class="memdesc:a63d15f6d3662262cab274d1035f472ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Duplicate each equation, multiplying by -1. <br /></td></tr>
<tr class="separator:a63d15f6d3662262cab274d1035f472ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d9b92dee76c21e9763dcbaf2f5dc7cb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStackSolver.html#a6d9b92dee76c21e9763dcbaf2f5dc7cb">propagate</a> (int4 varnum, int4 val)</td></tr>
<tr class="memdesc:a6d9b92dee76c21e9763dcbaf2f5dc7cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Propagate solution for one variable to other variables.  <a href="#a6d9b92dee76c21e9763dcbaf2f5dc7cb">More...</a><br /></td></tr>
<tr class="separator:a6d9b92dee76c21e9763dcbaf2f5dc7cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a8558523712d6396c8b668a35f3961772"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a8558523712d6396c8b668a35f3961772"></a>
vector&lt; <a class="el" href="structStackEqn.html">StackEqn</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStackSolver.html#a8558523712d6396c8b668a35f3961772">eqs</a></td></tr>
<tr class="memdesc:a8558523712d6396c8b668a35f3961772"><td class="mdescLeft">&#160;</td><td class="mdescRight">Known equations based on operations that explicitly change the stack-pointer. <br /></td></tr>
<tr class="separator:a8558523712d6396c8b668a35f3961772"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0c5d3270c0b51afd220f29b83b829dc"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab0c5d3270c0b51afd220f29b83b829dc"></a>
vector&lt; <a class="el" href="structStackEqn.html">StackEqn</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStackSolver.html#ab0c5d3270c0b51afd220f29b83b829dc">guess</a></td></tr>
<tr class="memdesc:ab0c5d3270c0b51afd220f29b83b829dc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Guessed equations for underdetermined systems. <br /></td></tr>
<tr class="separator:ab0c5d3270c0b51afd220f29b83b829dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab11343c6ad384291ecf8fff4fef20d7f"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab11343c6ad384291ecf8fff4fef20d7f"></a>
vector&lt; <a class="el" href="classVarnode.html">Varnode</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStackSolver.html#ab11343c6ad384291ecf8fff4fef20d7f">vnlist</a></td></tr>
<tr class="memdesc:ab11343c6ad384291ecf8fff4fef20d7f"><td class="mdescLeft">&#160;</td><td class="mdescRight">The indexed set of variables, one for each reference to the stack-pointer. <br /></td></tr>
<tr class="separator:ab11343c6ad384291ecf8fff4fef20d7f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6385bbf9813800c50ee5626ff9d392c8"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6385bbf9813800c50ee5626ff9d392c8"></a>
vector&lt; int4 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStackSolver.html#a6385bbf9813800c50ee5626ff9d392c8">companion</a></td></tr>
<tr class="memdesc:a6385bbf9813800c50ee5626ff9d392c8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Index of companion input for variable produced by CPUI_INDIRECT. <br /></td></tr>
<tr class="separator:a6385bbf9813800c50ee5626ff9d392c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4fdf6c77e205b59ca3e3216c5e078eb"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab4fdf6c77e205b59ca3e3216c5e078eb"></a>
<a class="el" href="classAddress.html">Address</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStackSolver.html#ab4fdf6c77e205b59ca3e3216c5e078eb">spacebase</a></td></tr>
<tr class="memdesc:ab4fdf6c77e205b59ca3e3216c5e078eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Starting address of the stack-pointer. <br /></td></tr>
<tr class="separator:ab4fdf6c77e205b59ca3e3216c5e078eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af801ea8ccc871df16de7c77f0cd50318"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af801ea8ccc871df16de7c77f0cd50318"></a>
vector&lt; int4 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStackSolver.html#af801ea8ccc871df16de7c77f0cd50318">soln</a></td></tr>
<tr class="memdesc:af801ea8ccc871df16de7c77f0cd50318"><td class="mdescLeft">&#160;</td><td class="mdescRight">Collected solutions (corresponding to array of variables) <br /></td></tr>
<tr class="separator:af801ea8ccc871df16de7c77f0cd50318"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2a5aba054e0040a2f4b31877af27463"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac2a5aba054e0040a2f4b31877af27463"></a>
int4&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStackSolver.html#ac2a5aba054e0040a2f4b31877af27463">missedvariables</a></td></tr>
<tr class="memdesc:ac2a5aba054e0040a2f4b31877af27463"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of variables for which we are missing an equation. <br /></td></tr>
<tr class="separator:ac2a5aba054e0040a2f4b31877af27463"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A class that solves for stack-pointer changes across unknown sub-functions. </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a136feaaa59c88d2a2b003621a78b0511"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StackSolver::build </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classFuncdata.html">Funcdata</a> &amp;&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classAddrSpace.html">AddrSpace</a> *&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int4&#160;</td>
          <td class="paramname"><em>spcbase</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Build the system of equations. </p>
<p>Collect references to the stack-pointer as variables, and examine their defining PcodeOps to determine equations and coefficient. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">data</td><td>is the function being analyzed </td></tr>
    <tr><td class="paramname">id</td><td>is the <em>stack</em> address space </td></tr>
    <tr><td class="paramname">spcbase</td><td>is the index, relative to the stack space, of the stack pointer </td></tr>
  </table>
  </dd>
</dl>

<p>References <a class="el" href="classFuncdata.html#a6057f2bc7180ba1232bfd80f5c1f8c21">Funcdata::beginLoc()</a>, <a class="el" href="classPcodeOp.html#a7ea2c706ee84cf2572141321a04d94f4">PcodeOp::code()</a>, <a class="el" href="classVarnode.html#a5739fd0f16b4321090f1108a4c618229">Varnode::comparePointers()</a>, <a class="el" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7a36a10374a26740a58b5625f340f6ffad">CPUI_COPY</a>, <a class="el" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7aa89e33b07a26ca7d26b54315e45c8424">CPUI_INDIRECT</a>, <a class="el" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7ab13948fae3194faced3994780ca08061">CPUI_INT_ADD</a>, <a class="el" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7ae3942b7ee09733bcf388c575eb4b60cc">CPUI_INT_AND</a>, <a class="el" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7a108d223da48e77fa181637fc3e75d9e8">CPUI_MULTIEQUAL</a>, <a class="el" href="classFuncdata.html#ac26dd8e3e8bad84b79a9a452bd953d8f">Funcdata::endLoc()</a>, <a class="el" href="classProtoModel.html#a0dd1871a456f9289660766c333448ba5ab0874d825448e7c731717fad59bbec92">ProtoModel::extrapop_unknown</a>, <a class="el" href="classVarnode.html#a128ca9ceeb101837c78cce9cdfe842c5">Varnode::getAddr()</a>, <a class="el" href="classFuncdata.html#af124852dcf002f34a811ec7c78f086f2">Funcdata::getCallSpecs()</a>, <a class="el" href="classVarnode.html#a8f227a762a3baec9ffa6962c5298e3a3">Varnode::getDef()</a>, <a class="el" href="classPcodeOp.html#a346b81187c4eab2f5e0ced8b455c1531">PcodeOp::getIn()</a>, <a class="el" href="classVarnode.html#a0c8f14c382ed1f493411b4ccb3e4841a">Varnode::getOffset()</a>, <a class="el" href="classPcodeOp.html#a41be82b850ff5185e51268aead2c2802">PcodeOp::getOpFromConst()</a>, <a class="el" href="classVarnode.html#aba88f8fa19ffe2c7c842da40ecce7a44">Varnode::getSpace()</a>, <a class="el" href="classAddrSpace.html#a3b16390dfa556c9bdd6fe5b31448f7d7">AddrSpace::getSpacebase()</a>, <a class="el" href="classAddrSpace.html#a219ee14b2c9fef027078b63c8b485e76">AddrSpace::getType()</a>, <a class="el" href="space_8hh.html#a1a83535cca68b7ca3f25bfad70262231ad644dc33b71c7d421fcd0fb2003407c7">IPTR_IOP</a>, <a class="el" href="classVarnode.html#a39a4b23694e20ba10562cb93abd4b7b1">Varnode::isConstant()</a>, <a class="el" href="classPcodeOp.html#af426e964bfc805355abdf5ca4e058133">PcodeOp::numInput()</a>, <a class="el" href="structStackEqn.html#a6077381330daeeed1ec22e242761d29a">StackEqn::rhs</a>, <a class="el" href="structStackEqn.html#a1253961b333617e44f2b5d564aac24cf">StackEqn::var1</a>, and <a class="el" href="structStackEqn.html#abc7b655e450f6f406111c4ca07366c37">StackEqn::var2</a>.</p>

<p>Referenced by <a class="el" href="classActionStackPtrFlow.html#a4f93079a3ade269842842a7fad126a12">ActionStackPtrFlow::analyzeExtraPop()</a>.</p>

</div>
</div>
<a class="anchor" id="a6d9b92dee76c21e9763dcbaf2f5dc7cb"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void StackSolver::propagate </td>
          <td>(</td>
          <td class="paramtype">int4&#160;</td>
          <td class="paramname"><em>varnum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int4&#160;</td>
          <td class="paramname"><em>val</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Propagate solution for one variable to other variables. </p>
<p>Given a solution for one variable, look for equations containing the variable and attempt to solve for the other variable. Continue propagating new solutions to other equations to find even more solutions. Populate the <b>soln</b> array with the solutions. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">varnum</td><td>is the index of the initial variable </td></tr>
    <tr><td class="paramname">val</td><td>is the solution for the variable </td></tr>
  </table>
  </dd>
</dl>

<p>References <a class="el" href="structStackEqn.html#ac0a43b31e135824bcbc459c48839c61b">StackEqn::compare()</a>, <a class="el" href="structStackEqn.html#a1253961b333617e44f2b5d564aac24cf">StackEqn::var1</a>, and <a class="el" href="structStackEqn.html#abc7b655e450f6f406111c4ca07366c37">StackEqn::var2</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>coreaction.cc</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
