<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>decompiler: LoadGuard Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">decompiler
   &#160;<span id="projectnumber">1.0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="#friends">Friends</a> &#124;
<a href="classLoadGuard-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">LoadGuard Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Description of a LOAD operation that needs to be guarded.  
 <a href="classLoadGuard.html#details">More...</a></p>

<p><code>#include &lt;heritage.hh&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a30cf132fe5bd153e24ba4debd82ecd64"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a30cf132fe5bd153e24ba4debd82ecd64"></a>
<a class="el" href="classPcodeOp.html">PcodeOp</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLoadGuard.html#a30cf132fe5bd153e24ba4debd82ecd64">getOp</a> (void) const </td></tr>
<tr class="memdesc:a30cf132fe5bd153e24ba4debd82ecd64"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the <a class="el" href="classPcodeOp.html" title="Lowest level operation of the p-code language. ">PcodeOp</a> being guarded. <br /></td></tr>
<tr class="separator:a30cf132fe5bd153e24ba4debd82ecd64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a519092801f6b10829a5c609032c4ae87"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a519092801f6b10829a5c609032c4ae87"></a>
uintb&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLoadGuard.html#a519092801f6b10829a5c609032c4ae87">getMinimum</a> (void) const </td></tr>
<tr class="memdesc:a519092801f6b10829a5c609032c4ae87"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get minimum offset of the guarded range. <br /></td></tr>
<tr class="separator:a519092801f6b10829a5c609032c4ae87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83915166fe47439eadcfbdcf79ee5671"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a83915166fe47439eadcfbdcf79ee5671"></a>
uintb&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLoadGuard.html#a83915166fe47439eadcfbdcf79ee5671">getMaximum</a> (void) const </td></tr>
<tr class="memdesc:a83915166fe47439eadcfbdcf79ee5671"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get maximum offset of the guarded range. <br /></td></tr>
<tr class="separator:a83915166fe47439eadcfbdcf79ee5671"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa50857a7d5aa2be274c815efb6d38554"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa50857a7d5aa2be274c815efb6d38554"></a>
int4&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLoadGuard.html#aa50857a7d5aa2be274c815efb6d38554">getStep</a> (void) const </td></tr>
<tr class="memdesc:aa50857a7d5aa2be274c815efb6d38554"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the calculated step associated with the range (or 0) <br /></td></tr>
<tr class="separator:aa50857a7d5aa2be274c815efb6d38554"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5b19c5e7e5b6c50e3c4d8caa2f7390f"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLoadGuard.html#ab5b19c5e7e5b6c50e3c4d8caa2f7390f">isGuarded</a> (const <a class="el" href="classAddress.html">Address</a> &amp;addr) const </td></tr>
<tr class="memdesc:ab5b19c5e7e5b6c50e3c4d8caa2f7390f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Does <b>this</b> guard apply to the given address.  <a href="#ab5b19c5e7e5b6c50e3c4d8caa2f7390f">More...</a><br /></td></tr>
<tr class="separator:ab5b19c5e7e5b6c50e3c4d8caa2f7390f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae79643817279d93ecb7ee2e0ebfa0b0"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aae79643817279d93ecb7ee2e0ebfa0b0"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLoadGuard.html#aae79643817279d93ecb7ee2e0ebfa0b0">isRangeLocked</a> (void) const </td></tr>
<tr class="memdesc:aae79643817279d93ecb7ee2e0ebfa0b0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return <b>true</b> if the range is fully determined. <br /></td></tr>
<tr class="separator:aae79643817279d93ecb7ee2e0ebfa0b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac8abc6f4c37a6258da9a99279120fc6"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aac8abc6f4c37a6258da9a99279120fc6"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLoadGuard.html#aac8abc6f4c37a6258da9a99279120fc6">isValid</a> (<a class="el" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7">OpCode</a> opc) const </td></tr>
<tr class="memdesc:aac8abc6f4c37a6258da9a99279120fc6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return <b>true</b> if the record still describes an active LOAD. <br /></td></tr>
<tr class="separator:aac8abc6f4c37a6258da9a99279120fc6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:af5f21fe404934e7ea77c39450875ae65"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLoadGuard.html#af5f21fe404934e7ea77c39450875ae65">establishRange</a> (const <a class="el" href="classValueSetRead.html">ValueSetRead</a> &amp;valueSet)</td></tr>
<tr class="memdesc:af5f21fe404934e7ea77c39450875ae65"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert partial value set analysis into guard range.  <a href="#af5f21fe404934e7ea77c39450875ae65">More...</a><br /></td></tr>
<tr class="separator:af5f21fe404934e7ea77c39450875ae65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a34f49c8dca6df740f4a31b8d4d6fcc"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6a34f49c8dca6df740f4a31b8d4d6fcc"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLoadGuard.html#a6a34f49c8dca6df740f4a31b8d4d6fcc">finalizeRange</a> (const <a class="el" href="classValueSetRead.html">ValueSetRead</a> &amp;valueSet)</td></tr>
<tr class="memdesc:a6a34f49c8dca6df740f4a31b8d4d6fcc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert value set analysis to final guard range. <br /></td></tr>
<tr class="separator:a6a34f49c8dca6df740f4a31b8d4d6fcc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaeceedc72a4eea9daba0edb0c9c93eda"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLoadGuard.html#aaeceedc72a4eea9daba0edb0c9c93eda">set</a> (<a class="el" href="classPcodeOp.html">PcodeOp</a> *o, <a class="el" href="classAddrSpace.html">AddrSpace</a> *s, uintb off)</td></tr>
<tr class="memdesc:aaeceedc72a4eea9daba0edb0c9c93eda"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set a new unanalyzed LOAD guard that initially guards everything.  <a href="#aaeceedc72a4eea9daba0edb0c9c93eda">More...</a><br /></td></tr>
<tr class="separator:aaeceedc72a4eea9daba0edb0c9c93eda"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a209e755a1fe8712c9b6e87d7a94862a5"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a209e755a1fe8712c9b6e87d7a94862a5"></a>
<a class="el" href="classPcodeOp.html">PcodeOp</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLoadGuard.html#a209e755a1fe8712c9b6e87d7a94862a5">op</a></td></tr>
<tr class="memdesc:a209e755a1fe8712c9b6e87d7a94862a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">The LOAD op. <br /></td></tr>
<tr class="separator:a209e755a1fe8712c9b6e87d7a94862a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9765ce20df002a86c1955ae00ca75785"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9765ce20df002a86c1955ae00ca75785"></a>
<a class="el" href="classAddrSpace.html">AddrSpace</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLoadGuard.html#a9765ce20df002a86c1955ae00ca75785">spc</a></td></tr>
<tr class="memdesc:a9765ce20df002a86c1955ae00ca75785"><td class="mdescLeft">&#160;</td><td class="mdescRight">The stack space being loaded from. <br /></td></tr>
<tr class="separator:a9765ce20df002a86c1955ae00ca75785"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e720cf18af33abe78aa524f56e2fe51"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4e720cf18af33abe78aa524f56e2fe51"></a>
uintb&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLoadGuard.html#a4e720cf18af33abe78aa524f56e2fe51">pointerBase</a></td></tr>
<tr class="memdesc:a4e720cf18af33abe78aa524f56e2fe51"><td class="mdescLeft">&#160;</td><td class="mdescRight">Base offset of the pointer. <br /></td></tr>
<tr class="separator:a4e720cf18af33abe78aa524f56e2fe51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05a86fd59865a06da11d31fc39725046"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a05a86fd59865a06da11d31fc39725046"></a>
uintb&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLoadGuard.html#a05a86fd59865a06da11d31fc39725046">minimumOffset</a></td></tr>
<tr class="memdesc:a05a86fd59865a06da11d31fc39725046"><td class="mdescLeft">&#160;</td><td class="mdescRight">Minimum offset of the LOAD. <br /></td></tr>
<tr class="separator:a05a86fd59865a06da11d31fc39725046"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c80c1d6ce27cdcdb1102238eef20989"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5c80c1d6ce27cdcdb1102238eef20989"></a>
uintb&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLoadGuard.html#a5c80c1d6ce27cdcdb1102238eef20989">maximumOffset</a></td></tr>
<tr class="memdesc:a5c80c1d6ce27cdcdb1102238eef20989"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum offset of the LOAD. <br /></td></tr>
<tr class="separator:a5c80c1d6ce27cdcdb1102238eef20989"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8fc286ab623d00f81eb988bf0c9e4eb"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa8fc286ab623d00f81eb988bf0c9e4eb"></a>
int4&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLoadGuard.html#aa8fc286ab623d00f81eb988bf0c9e4eb">step</a></td></tr>
<tr class="memdesc:aa8fc286ab623d00f81eb988bf0c9e4eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Step of any access into this range (0=unknown) <br /></td></tr>
<tr class="separator:aa8fc286ab623d00f81eb988bf0c9e4eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6a1b2e627bbe10d8977f4944486634e"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae6a1b2e627bbe10d8977f4944486634e"></a>
int4&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLoadGuard.html#ae6a1b2e627bbe10d8977f4944486634e">analysisState</a></td></tr>
<tr class="memdesc:ae6a1b2e627bbe10d8977f4944486634e"><td class="mdescLeft">&#160;</td><td class="mdescRight">0=unanalyzed, 1=analyzed(partial result), 2=analyzed(full result) <br /></td></tr>
<tr class="separator:ae6a1b2e627bbe10d8977f4944486634e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:a856a6ac40847cd2931af8dbd470881cb"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a856a6ac40847cd2931af8dbd470881cb"></a>
class&#160;</td><td class="memItemRight" valign="bottom"><b>Heritage</b></td></tr>
<tr class="separator:a856a6ac40847cd2931af8dbd470881cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Description of a LOAD operation that needs to be guarded. </p>
<p><a class="el" href="classHeritage.html" title="Manage the construction of Static Single Assignment (SSA) form. ">Heritage</a> maintains a list of CPUI_LOAD ops that reference the stack dynamically. These can potentially alias stack Varnodes, so we maintain what (possibly limited) information we known about the range of stack addresses that can be referenced. </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="af5f21fe404934e7ea77c39450875ae65"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void LoadGuard::establishRange </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classValueSetRead.html">ValueSetRead</a> &amp;&#160;</td>
          <td class="paramname"><em>valueSet</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Convert partial value set analysis into guard range. </p>
<p>Make some determination of the range of possible values for a LOAD based an partial value set analysis. This can sometimes get</p><ul>
<li>minimumOffset - otherwise the original constant pulled with the LOAD is used</li>
<li>step - the partial analysis shows step and direction</li>
<li>maximumOffset - in rare cases</li>
</ul>
<p>isAnalyzed is set to <b>true</b>, if full range analysis is not needed </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">valueSet</td><td>is the calculated value set as seen by the LOAD operation </td></tr>
  </table>
  </dd>
</dl>

<p>References <a class="el" href="classValueSetRead.html#ad43d2b411362879396c7da9426462d98">ValueSetRead::getRange()</a>, <a class="el" href="classCircleRange.html#a92c89f577cc8552b4fa38645eaba1a37">CircleRange::getSize()</a>, <a class="el" href="classValueSetRead.html#a007faa1e1a4c55063c6fa0cef94bbf42">ValueSetRead::isLeftStable()</a>, and <a class="el" href="classValueSetRead.html#a04284c758c96b4838cb1a1ab12da5695">ValueSetRead::isRightStable()</a>.</p>

<p>Referenced by <a class="el" href="classHeritage.html#a7d518d053e1834e600be703ba0ac91b1">Heritage::analyzeNewLoadGuards()</a>.</p>

</div>
</div>
<a class="anchor" id="ab5b19c5e7e5b6c50e3c4d8caa2f7390f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool LoadGuard::isGuarded </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classAddress.html">Address</a> &amp;&#160;</td>
          <td class="paramname"><em>addr</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Does <b>this</b> guard apply to the given address. </p>
<p>Check if the address falls within the range defined by <b>this</b> </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">addr</td><td>is the given address </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><b>true</b> if the address is contained </dd></dl>

<p>References <a class="el" href="classAddress.html#a90e9bc454f258c51c1ddccc336922a8d">Address::getOffset()</a>, and <a class="el" href="classAddress.html#acb7255960e441327e10b24442d44a2bd">Address::getSpace()</a>.</p>

<p>Referenced by <a class="el" href="classRuleIndirectCollapse.html#a0d4041209c44deabc2baa829c022d642">RuleIndirectCollapse::applyOp()</a>.</p>

</div>
</div>
<a class="anchor" id="aaeceedc72a4eea9daba0edb0c9c93eda"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void LoadGuard::set </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPcodeOp.html">PcodeOp</a> *&#160;</td>
          <td class="paramname"><em>o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classAddrSpace.html">AddrSpace</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uintb&#160;</td>
          <td class="paramname"><em>off</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set a new unanalyzed LOAD guard that initially guards everything. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">o</td><td>is the LOAD op </td></tr>
    <tr><td class="paramname">s</td><td>is the (stack) space it is loading from </td></tr>
    <tr><td class="paramname">off</td><td>is the base offset that is indexed from </td></tr>
  </table>
  </dd>
</dl>

<p>References <a class="el" href="classAddrSpace.html#a592b7cfae93217aac10c62dd63b30941">AddrSpace::getHighest()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="heritage_8hh.html">heritage.hh</a></li>
<li>heritage.cc</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
